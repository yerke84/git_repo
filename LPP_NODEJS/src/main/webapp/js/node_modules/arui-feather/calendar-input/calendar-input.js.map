{"version":3,"sources":["calendar-input/calendar-input.jsx"],"names":["CUSTOM_DATE_FORMAT","NATIVE_DATE_FORMAT","IS_BROWSER","window","SUPPORTS_INPUT_TYPE_DATE","inputtypes","date","parseDate","value","format","valueTrimmed","replace","result","length","match","valueDate","valueOf","formatDateIntoCustom","formatDateIntoNative","calculateMonth","newValue","Date","now","CalendarInput","state","isNativeInputEnabled","isInputFocused","isCalendarFocused","opened","month","props","calendarPopup","element","nativeCalendarTarget","customCalendarTarget","getBoxNode","setTarget","timeoutId","clearTimeout","changeCloseTimeoutId","cn","Input","Popup","undefined","commonProps","disabled","tabIndex","noValidate","width","error","size","placeholder","id","name","handleCustomInputBlur","handleCustomInputChange","handleCustomInputFocus","handleInputKeyDown","withIcon","handleIconClick","handleMqMatchChange","handleNativeInputBlur","handleNativeInputChange","handleNativeInputFocus","renderPopup","directions","calendar","handleCalendarBlur","handleCalendarFocus","handleCalendarKeyDown","handleCalendarChange","handleCalendarMonthChange","formatted","isTriggeredByKeyboard","setTimeout","blur","setState","onCalendarChange","onChange","event","changeFocused","which","ESCAPE","preventDefault","focus","ENTER","SPACE","onCalendarKeyDown","onKeyDown","onInputChange","target","onInputFocus","resultEvent","onInputBlur","DOWN_ARROW","onInputKeyDown","isMatched","targetRef","scrollTo","focusedState","newState","relatedTarget","explicitOriginalTarget","document","activeElement","calendarWillReceiveFocus","getNode","newFocused","newOpened","onFocus","onBlur","newMonth","Component","propTypes","string","node","shape","number","selectedFrom","selectedTo","earlierLimit","laterLimit","onValueChange","func","onMonthChange","outputFormat","months","arrayOf","weekdays","offDays","showArrows","bool","isKeyboard","theme","oneOf","className","oneOfType","onKeyUp","defaultProps"],"mappings":"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","file":"calendar-input.js","sourcesContent":["/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { autobind } from 'core-decorators';\nimport React from 'react';\nimport Type from 'prop-types';\n\nimport startOfDay from 'date-fns/start_of_day';\nimport formatDate from 'date-fns/format';\nimport isDateValid from 'date-fns/is_valid';\n\nimport Calendar from '../calendar/calendar';\nimport Icon from '../icon/icon';\nimport Input from '../input/input';\nimport Mq from '../mq/mq';\nimport Popup from '../popup/popup';\n\nimport cn from '../cn';\nimport keyboardCode from '../lib/keyboard-code';\nimport Modernizr from '../modernizr';\nimport { isNodeOutsideElement } from '../lib/window';\nimport { parse } from '../lib/date-utils';\nimport performance from '../performance';\n\n/**\n * NB: В нативном календаре нельзя менять формат даты. Приемлем только YYYY-MM-DD формат.\n * https://www.w3.org/TR/html-markup/input.date.html#input.date.attrs.value\n * https://tools.ietf.org/html/rfc3339#section-5.6\n*/\nconst CUSTOM_DATE_FORMAT = 'DD.MM.YYYY';\nconst NATIVE_DATE_FORMAT = 'YYYY-MM-DD';\nconst IS_BROWSER = typeof window !== 'undefined';\nconst SUPPORTS_INPUT_TYPE_DATE = IS_BROWSER && Modernizr.inputtypes.date;\n\nfunction parseDate(value, format) {\n    const valueTrimmed = value ? value.replace(/~+$/, '') : '';\n    let result = null;\n\n    // Проверяем, чтобы пользователь ввёл полную строку даты без пробелов.\n    if (valueTrimmed.length === format.length && !valueTrimmed.match(/\\s/)) {\n        let valueDate = parse(valueTrimmed, format);\n        if (isDateValid(valueDate)) {\n            result = valueDate.valueOf();\n        }\n    }\n\n    return result;\n}\n\nfunction formatDateIntoCustom(value) {\n    let date = parseDate(value, NATIVE_DATE_FORMAT);\n\n    if (date) {\n        return formatDate(date, CUSTOM_DATE_FORMAT);\n    }\n    return value;\n}\n\nfunction formatDateIntoNative(value) {\n    let date = parseDate(value, CUSTOM_DATE_FORMAT);\n\n    if (date) {\n        return formatDate(date, NATIVE_DATE_FORMAT);\n    }\n    return value;\n}\n\nfunction calculateMonth(value) {\n    let newValue = (value && parseDate(value, CUSTOM_DATE_FORMAT)) || Date.now();\n\n    return startOfDay(newValue).valueOf();\n}\n\n/**\n * Компонент поля ввода даты.\n */\n@cn('calendar-input', Input, Popup)\n@performance(true)\nclass CalendarInput extends React.Component {\n    static propTypes = {\n        /** Содержимое поля ввода, указанное по умолчанию */\n        value: Type.string,\n        /** Отображение попапа с ошибкой в момент когда фокус находится в поле ввода */\n        error: Type.node,\n        /** Свойства компонента [Calendar](../calendar/) */\n        calendar: Type.shape({\n            value: Type.number,\n            selectedFrom: Type.number,\n            selectedTo: Type.number,\n            earlierLimit: Type.number,\n            laterLimit: Type.number,\n            month: Type.number,\n            onValueChange: Type.func,\n            onMonthChange: Type.func,\n            outputFormat: Type.string,\n            months: Type.arrayOf(Type.string),\n            weekdays: Type.arrayOf(Type.string),\n            offDays: Type.arrayOf(Type.number),\n            showArrows: Type.bool,\n            isKeyboard: Type.bool,\n            error: Type.node,\n            theme: Type.oneOf(['alfa-on-color', 'alfa-on-white']),\n            className: Type.oneOfType([Type.func, Type.string]),\n            onKeyDown: Type.func,\n            onKeyUp: Type.func,\n            onFocus: Type.func,\n            onBlur: Type.func\n        }),\n        /** Управление возможностью раскрытия календаря */\n        opened: Type.bool,\n        /** Управление возможностью компонента занимать всю ширину родителя */\n        width: Type.oneOf(['default', 'available']),\n        /** Направления, в которые может открываться попап компонента */\n        directions: Type.arrayOf(Type.oneOf([\n            'anchor', 'top-left', 'top-center', 'top-right', 'left-top', 'left-center', 'left-bottom', 'right-top',\n            'right-center', 'right-bottom', 'bottom-left', 'bottom-center', 'bottom-right'\n        ])),\n        /** Управление возможностью изменения значения компонента */\n        disabled: Type.bool,\n        /** Размер компонента */\n        size: Type.oneOf(['s', 'm', 'l', 'xl']),\n        /** Последовательность перехода между контролами при нажатии на Tab */\n        tabIndex: Type.number,\n        /** Показывать иконку календаря в инпуте */\n        withIcon: Type.bool,\n        /** Подсказка в текстовом поле */\n        placeholder: Type.string,\n        /** Идентификатор компонента в DOM */\n        id: Type.string,\n        /** Имя компонента в DOM */\n        name: Type.string,\n        /** Тема компонента */\n        theme: Type.oneOf(['alfa-on-color', 'alfa-on-white']),\n        /** Обработчик установки фокуса на компонент */\n        onFocus: Type.func,\n        /** Обработчик снятия фокуса с компонента */\n        onBlur: Type.func,\n        /** Обработчик установки фокуса на поле ввода */\n        onInputFocus: Type.func,\n        /** Обработчик снятия фокуса с поля ввода */\n        onInputBlur: Type.func,\n        /** Обработчик ввода даты в текстовом поле */\n        onInputChange: Type.func,\n        /** Обработчик выбора даты в календаре */\n        onCalendarChange: Type.func,\n        /** Обрабочик изменения даты в календаре */\n        onChange: Type.func,\n        /** Обработчик события нажатия на клавишу в момент, когда фокус находится на компоненте */\n        onKeyDown: Type.func,\n        /** Обработчик события нажатия на клавишу клавиатуры в момент, когда фокус находится в календаре */\n        onCalendarKeyDown: Type.func,\n        /** Обработчик события нажатия на клавишу клавиатуры в момент, когда фокус находится на текстовом поле */\n        onInputKeyDown: Type.func\n    };\n\n    static defaultProps = {\n        withIcon: true,\n        directions: ['bottom-left', 'bottom-right', 'top-left', 'top-right'],\n        placeholder: '00.00.0000'\n    };\n\n    state = {\n        isNativeInputEnabled: false,\n        isInputFocused: false,\n        isCalendarFocused: false,\n        opened: false,\n        value: '',\n        month: calculateMonth(this.props.value)\n    };\n\n    /**\n     * @type {Number}\n     */\n    timeoutId;\n\n    /**\n     * @type {Number}\n     */\n    changeCloseTimeoutId;\n\n    /**\n     * @type {Calendar}\n     */\n    calendar;\n\n    /**\n     * @type {Popup}\n     */\n    calendarPopup;\n\n    /**\n     * @type {Input}\n     */\n    customCalendarTarget;\n\n    /**\n     * @type {HTMLInputElement}\n     */\n    nativeCalendarTarget;\n\n    componentDidMount() {\n        if (this.calendarPopup) {\n            let element;\n\n            if (this.nativeCalendarTarget) {\n                element = this.nativeCalendarTarget;\n            } else if (this.customCalendarTarget) {\n                element = this.customCalendarTarget.getBoxNode();\n            }\n\n            if (element) {\n                this.calendarPopup.setTarget(element);\n            }\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.timeoutId) {\n            clearTimeout(this.timeoutId);\n            this.timeoutId = null;\n        }\n        if (this.changeCloseTimeoutId) {\n            clearTimeout(this.changeCloseTimeoutId);\n            this.changeCloseTimeoutId = null;\n        }\n    }\n\n    render(cn, Input, Popup) {\n        let value = this.props.value !== undefined\n            ? this.props.value\n            : this.state.value;\n\n        let commonProps = {\n            disabled: this.props.disabled,\n            tabIndex: this.props.tabIndex,\n            noValidate: true\n        };\n\n        return (\n            <span className={ cn({ width: this.props.width }) }>\n                <Input\n                    ref={ (customCalendarTarget) => {\n                        this.customCalendarTarget = customCalendarTarget;\n                    } }\n                    { ...commonProps }\n                    className={ cn('custom-field') }\n                    disabledAttr={ this.state.isNativeInputEnabled }\n                    error={ this.props.error }\n                    focused={ this.state.isInputFocused || this.state.isCalendarFocused }\n                    mask='11.11.1111'\n                    size={ this.props.size }\n                    type='text'\n                    placeholder={ this.props.placeholder }\n                    value={ value }\n                    width={ this.props.width }\n                    id={ this.props.id }\n                    name={ this.props.name }\n                    onBlur={ this.handleCustomInputBlur }\n                    onChange={ this.handleCustomInputChange }\n                    onFocus={ this.handleCustomInputFocus }\n                    onKeyDown={ this.handleInputKeyDown }\n                    icon={\n                        this.props.withIcon &&\n                        <Icon\n                            size={ this.props.size }\n                            icon='calendar'\n                            onClick={ this.handleIconClick }\n                        />\n                    }\n                />\n                <Mq\n                    query='--small-only'\n                    touch={ true }\n                    onMatchChange={ this.handleMqMatchChange }\n                >\n                    {\n                        SUPPORTS_INPUT_TYPE_DATE &&\n                        <input\n                            ref={ (nativeCalendarTarget) => {\n                                this.nativeCalendarTarget = nativeCalendarTarget;\n                            } }\n                            { ...commonProps }\n                            className={ cn('native-field') }\n                            type='date'\n                            value={ formatDateIntoNative(value) }\n                            onBlur={ this.handleNativeInputBlur }\n                            onChange={ this.handleNativeInputChange }\n                            onFocus={ this.handleNativeInputFocus }\n                        />\n                    }\n                </Mq>\n                { this.renderPopup(value, Popup) }\n            </span>\n        );\n    }\n\n    renderPopup(value, Popup) {\n        let opened = this.props.opened !== undefined\n            ? this.props.opened\n            : this.state.opened;\n\n        return (\n            <Popup\n                ref={ (calendarPopup) => { this.calendarPopup = calendarPopup; } }\n                for={ this.props.name }\n                autoclosable={ true }\n                visible={ opened }\n                directions={ this.props.directions }\n            >\n                <Calendar\n                    ref={ (calendar) => { this.calendar = calendar; } }\n                    month={ this.state.month }\n                    { ...this.props.calendar }\n                    value={ parseDate(value, CUSTOM_DATE_FORMAT) }\n                    onBlur={ this.handleCalendarBlur }\n                    onFocus={ this.handleCalendarFocus }\n                    onKeyDown={ this.handleCalendarKeyDown }\n                    onValueChange={ this.handleCalendarChange }\n                    onMonthChange={ this.handleCalendarMonthChange }\n                />\n            </Popup>\n        );\n    }\n\n    @autobind\n    handleCalendarChange(value, formatted, isTriggeredByKeyboard) {\n        if (!isTriggeredByKeyboard) {\n            this.changeCloseTimeoutId = setTimeout(() => {\n                this.calendar.blur(); // FF не испускает событие `blur` когда элементы становятся невидимыми, делаем это явно\n                this.setState({\n                    opened: false\n                });\n                this.changeCloseTimeoutId = null;\n            }, 0);\n        }\n\n        this.setState({ value: formatted });\n\n        if (this.props.onCalendarChange) {\n            this.props.onCalendarChange(formatted);\n        }\n\n        if (this.props.onChange) {\n            this.props.onChange(formatted, value);\n        }\n    }\n\n    @autobind\n    handleCalendarMonthChange(month) {\n        this.setState({\n            month\n        });\n    }\n\n    @autobind\n    handleCalendarFocus(event) {\n        this.changeFocused({ isCalendarFocused: true }, event);\n    }\n\n    @autobind\n    handleCalendarBlur(event) {\n        this.changeFocused({ isCalendarFocused: false }, event);\n    }\n\n    @autobind\n    handleCalendarKeyDown(event) {\n        switch (event.which) {\n            case keyboardCode.ESCAPE:\n                event.preventDefault();\n                this.customCalendarTarget.focus();\n                break;\n            case keyboardCode.ENTER:\n            case keyboardCode.SPACE:\n                event.preventDefault();\n                this.setState({\n                    opened: false\n                });\n                break;\n        }\n\n        if (this.props.onCalendarKeyDown) {\n            this.props.onCalendarKeyDown(event);\n        }\n\n        if (this.props.onKeyDown) {\n            this.props.onKeyDown(event);\n        }\n    }\n\n    @autobind\n    handleIconClick() {\n        this.customCalendarTarget.focus();\n    }\n\n    @autobind\n    handleCustomInputChange(value) {\n        let month = calculateMonth(value);\n\n        this.setState({ value });\n\n        // Изменяет месяц в календаре в соответствии с введёной в поле валидной датой\n        if (value && value.length === CUSTOM_DATE_FORMAT.length && month !== this.state.month) {\n            this.setState({ month });\n        }\n\n        if (this.props.onInputChange) {\n            this.props.onInputChange(value);\n        }\n\n        if (this.props.onChange) {\n            this.props.onChange(value, parseDate(value, CUSTOM_DATE_FORMAT));\n        }\n    }\n\n    @autobind\n    handleNativeInputChange(event) {\n        let value = formatDateIntoCustom(event.target.value);\n\n        // Детектим нажатие `сlear` в нативном календаре\n        if (this.state.value === value) {\n            value = '';\n        }\n\n        this.setState({ value });\n\n        if (this.props.onInputChange) {\n            this.props.onInputChange(value);\n        }\n\n        if (this.props.onChange) {\n            this.props.onChange(value, parseDate(value, CUSTOM_DATE_FORMAT));\n        }\n    }\n\n    @autobind\n    handleCustomInputFocus(event) {\n        this.changeFocused({ isInputFocused: true }, event);\n\n        if (this.props.onInputFocus) {\n            this.props.onInputFocus(event);\n        }\n    }\n\n    @autobind\n    handleNativeInputFocus(event) {\n        // Копируем пришедший из аргументов SyntheticEvent для дальнейшего редактирования\n        let resultEvent = { ...event,\n            // Трансформируем нативную YYYY-MM-DD дату в кастомный формат на вывод в коллбэках\n            target: { value: formatDateIntoCustom(event.target.value) }\n        };\n\n        this.changeFocused({ isInputFocused: true }, resultEvent);\n\n        if (this.props.onInputFocus) {\n            this.props.onInputFocus(resultEvent);\n        }\n    }\n\n    @autobind\n    handleCustomInputBlur(event) {\n        this.changeFocused({ isInputFocused: false }, event);\n\n        if (this.props.onInputBlur) {\n            this.props.onInputBlur(event);\n        }\n    }\n\n    @autobind\n    handleNativeInputBlur(event) {\n        // Копируем пришедший из аргументов SyntheticEvent для дальнейшего редактирования\n        let resultEvent = { ...event,\n            // Трансформируем нативную YYYY-MM-DD дату в кастомный формат на вывод в коллбэках\n            target: { value: formatDateIntoCustom(event.target.value) }\n        };\n\n        this.changeFocused({ isInputFocused: false }, resultEvent);\n\n        if (this.props.onInputBlur) {\n            this.props.onInputBlur(resultEvent);\n        }\n    }\n\n    @autobind\n    handleInputKeyDown(event) {\n        switch (event.which) {\n            case keyboardCode.DOWN_ARROW: {\n                event.preventDefault();\n\n                let value = this.props.value !== undefined\n                    ? this.props.value\n                    : this.state.value;\n\n                this.setState({\n                    opened: true,\n                    month: calculateMonth(value)\n                });\n                this.calendar.focus();\n\n                break;\n            }\n            case keyboardCode.ESCAPE: {\n                event.preventDefault();\n\n                this.setState({\n                    opened: false\n                });\n\n                break;\n            }\n        }\n\n        if (this.props.onInputKeyDown) {\n            this.props.onInputKeyDown(event);\n        }\n\n        if (this.props.onKeyDown) {\n            this.props.onKeyDown(event);\n        }\n    }\n\n    @autobind\n    handleMqMatchChange(isMatched) {\n        this.setState({\n            isNativeInputEnabled: isMatched && SUPPORTS_INPUT_TYPE_DATE\n        });\n    }\n\n    /**\n     * Устанавливает фокус на поле ввода, открывает календарь.\n     *\n     * @public\n     */\n    focus() {\n        let targetRef = this.nativeCalendarTarget || this.customCalendarTarget;\n\n        targetRef.focus();\n    }\n\n    /**\n     * Убирает фокус с поля ввода.\n     *\n     * @public\n     */\n    blur() {\n        let targetRef = this.nativeCalendarTarget || this.customCalendarTarget;\n\n        targetRef.blur();\n    }\n\n    /**\n     * Скроллит страницу до поля ввода.\n     *\n     * @public\n     */\n    scrollTo() {\n        this.customCalendarTarget.scrollTo();\n    }\n\n    changeFocused(focusedState, event) {\n        let newState = {\n            isInputFocused: this.state.isInputFocused,\n            isCalendarFocused: this.state.isCalendarFocused,\n            ...focusedState\n        };\n\n        // При переключении фокуса с поля ввода на календарь событие `blur` у поля ввода иногда происходит перед фокусом календаря\n        // Поэтому проверяем элемент который получит фокус после блюра и если он внутри календаря - оставляем сфокусированное состояние.\n        let relatedTarget = event.relatedTarget || // не поддерживается в FF и IE10 https://github.com/facebook/react/issues/2011\n            event.explicitOriginalTarget || // не поддерживается в IE\n            document.activeElement; // В IE вернет не <calendar> а конкретную ноду, на которую пришел фокус\n\n        let calendarWillReceiveFocus = !isNodeOutsideElement(relatedTarget, this.calendar.getNode());\n\n        let newFocused = newState.isInputFocused\n            || newState.isCalendarFocused\n            || calendarWillReceiveFocus;\n\n        this.setState(focusedState);\n\n        let newOpened = false;\n\n        if (newFocused) {\n            if (this.props.onFocus) {\n                this.props.onFocus(event);\n            }\n\n            newOpened = true;\n        } else if (this.props.onBlur) {\n            this.props.onBlur(event);\n        }\n\n        if (!this.state.isNativeInputEnabled) {\n            if (this.timeoutId) {\n                clearTimeout(this.timeoutId);\n            }\n            this.timeoutId = setTimeout(() => {\n                let value = this.props.value !== undefined\n                    ? this.props.value\n                    : this.state.value;\n\n                let newMonth = this.state.opened !== newOpened\n                    ? calculateMonth(value)\n                    : this.state.month;\n\n                this.setState({\n                    opened: newOpened,\n                    month: newMonth\n                });\n\n                this.timeoutId = null;\n            }, 0);\n        }\n    }\n}\n\nexport default CalendarInput;\n"]}