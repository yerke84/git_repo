{"version":3,"sources":["header/header.jsx"],"names":["Header","state","fixed","colored","props","window","addEventListener","handleScroll","recountHeightStyleState","removeEventListener","cn","root","topContent","renderLogo","menu","user","support","handleResize","logo","handleLogoClick","solveFixedColoredState","event","onLogoClick","topContentHeight","offsetHeight","headerHeight","onResize","height","contentHeight","y","pageYOffset","topDataContainer","positionFixedBreakpoint","positionColoredBreakpoint","setState","Component","propTypes","string","node","bool","theme","oneOf","className","oneOfType","func","defaultProps"],"mappings":"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","file":"header.js","sourcesContent":["/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { autobind } from 'core-decorators';\nimport React from 'react';\nimport Type from 'prop-types';\n\nimport Link from '../link/link';\nimport ResizeSensor from '../resize-sensor/resize-sensor';\n\nimport cn from '../cn';\nimport performance from '../performance';\n\n/**\n * Компонент шапки сайта: лого, меню и пользовательский профиль.\n * Обычно используется совместно с компонентом `Page`.\n *\n * @example\n * ```javascript\n * import Page from 'arui-feather/page';\n * import Header from 'arui-feather/header';\n * import Footer from 'arui-feather/footer';\n *\n * <Page header={ <Header /> } footer={ <Footer /> }>\n *     Контент страницы...\n * </Page>\n * ```\n */\n@cn('header')\n@performance()\nclass Header extends React.Component {\n    static propTypes = {\n        root: Type.string,\n        /** Содержимое кастомного логотипа в шапке */\n        logo: Type.node,\n        /** Содержимое меню в шапке */\n        menu: Type.node,\n        /** Содержимое блока пользователя */\n        user: Type.node,\n        /** Содержимое блока контактов поддержки */\n        support: Type.node,\n        /** Произвольный контент над логотипом и меню */\n        topContent: Type.node,\n        /** Управление возможностью фиксирования шапки к верхнему краю окна */\n        fixed: Type.bool,\n        /** Тема компонента */\n        theme: Type.oneOf(['alfa-on-color', 'alfa-on-white']),\n        /** Дополнительный класс */\n        className: Type.oneOfType([Type.func, Type.string]),\n        /** Обработчик события изменение размера шапки */\n        onResize: Type.func,\n        /** Обработчик события клика по логотипу Альфа-Банк */\n        onLogoClick: Type.func\n    };\n\n    static defaultProps = {\n        root: '/',\n        logo: null,\n        fixed: false\n    };\n\n    state = {\n        fixed: false,\n        colored: false\n    };\n\n    height;\n    contentHeight;\n\n    root;\n    topContent;\n\n    componentDidMount() {\n        if (this.props.fixed) {\n            window.addEventListener('scroll', this.handleScroll);\n        }\n        this.recountHeightStyleState();\n    }\n\n    componentWillUnmount() {\n        if (this.props.fixed) {\n            window.removeEventListener('scroll', this.handleScroll);\n        }\n    }\n\n    render(cn) {\n        return (\n            <div className={ cn({ fixed: this.state.fixed }) } ref={ (root) => { this.root = root; } }>\n                { this.props.topContent &&\n                    <div className={ cn('top-content') } ref={ (topContent) => { this.topContent = topContent; } }>\n                        { this.props.topContent }\n                    </div>\n                }\n                <div className={ cn('main-case', { fixed: this.state.fixed, colored: this.state.colored }) }>\n                    <div className={ cn('inner') }>\n                        {\n                            this.renderLogo(cn)\n                        }\n                        <div className={ cn('content') }>\n                            { this.props.menu &&\n                                <div className={ cn('menu') }>\n                                    { this.props.menu }\n                                </div>\n                            }\n                            { this.props.user &&\n                                <div className={ cn('user') }>\n                                    { this.props.user }\n                                </div>\n                            }\n                            { this.props.support &&\n                                <div className={ cn('support') }>\n                                    { this.props.support }\n                                </div>\n                            }\n                        </div>\n                    </div>\n                </div>\n\n                <ResizeSensor onResize={ this.handleResize } />\n            </div>\n        );\n    }\n\n    renderLogo(cn) {\n        if (!this.props.logo) {\n            return null;\n        }\n\n        return (\n            <Link\n                url={ this.props.root }\n                className={ cn('logo') }\n                onClick={ this.handleLogoClick }\n            >\n                { this.props.logo }\n            </Link>\n        );\n    }\n\n    @autobind\n    handleScroll() {\n        this.solveFixedColoredState();\n    }\n\n    @autobind\n    handleResize() {\n        this.recountHeightStyleState();\n    }\n\n    @autobind\n    handleLogoClick(event) {\n        if (this.props.onLogoClick) {\n            this.props.onLogoClick(event);\n        }\n    }\n\n    recountHeightStyleState() {\n        let topContentHeight = (this.topContent && this.topContent.offsetHeight) || 0;\n        let headerHeight = this.root.offsetHeight;\n\n        if (this.props.onResize\n            && (headerHeight !== this.height || topContentHeight !== this.contentHeight)) {\n            this.props.onResize(headerHeight, topContentHeight);\n        }\n\n        this.contentHeight = topContentHeight;\n        this.height = headerHeight;\n\n        if (this.props.fixed) {\n            this.solveFixedColoredState();\n        }\n    }\n\n    solveFixedColoredState() {\n        let y = window.pageYOffset;\n        let topDataContainer = this.topContent;\n        let positionFixedBreakpoint = !this.props.topContent\n            ? 0\n            : topDataContainer.offsetHeight;\n\n        let positionColoredBreakpoint = !this.props.topContent\n            ? 10\n            : topDataContainer.offsetHeight;\n\n        if (y >= positionFixedBreakpoint) {\n            if (!this.state.fixed) {\n                this.setState({\n                    fixed: true\n                });\n            }\n        } else if (this.state.fixed) {\n            this.setState({\n                fixed: false\n            });\n        }\n\n        if (y >= positionColoredBreakpoint) {\n            if (!this.state.colored) {\n                this.setState({\n                    colored: true\n                });\n            }\n        } else if (this.state.colored) {\n            this.setState({\n                colored: false\n            });\n        }\n    }\n}\n\nexport default Header;\n"]}