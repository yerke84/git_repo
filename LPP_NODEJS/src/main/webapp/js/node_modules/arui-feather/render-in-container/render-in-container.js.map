{"version":3,"sources":["render-in-container/render-in-container.jsx"],"names":["RenderInContainer","buildElements","renderLayer","container","getContainer","unmountComponentAtNode","element","removeChild","props","className","toString","unstable_renderSubtreeIntoContainer","children","handleRender","onRender","document","body","createElement","appendChild","Component","propTypes","oneOfType","arrayOf","node","func","string"],"mappings":";;;;;;;;2CAAA;;;;AAIA;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;;;IAGMA,iB;;;;;;;;;;;4CAYkB;AAChB,iBAAKC,aAAL;AACA,iBAAKC,WAAL;AACH;;;6CAEoB;AACjB,gBAAI,KAAKC,SAAL,KAAmB,KAAKC,YAAL,EAAvB,EAA4C;AACxC,qBAAKH,aAAL;AACH;AACD,iBAAKC,WAAL;AACH;;;+CAEsB;AACnB,+BAASG,sBAAT,CAAgC,KAAKC,OAArC;AACA,iBAAKH,SAAL,CAAeI,WAAf,CAA2B,KAAKD,OAAhC;AACH;;;iCAEQ;AACL,mBAAO,KAAP;AACH;;;sCAEa;AACV,gBAAI,KAAKE,KAAL,CAAWC,SAAf,EAA0B;AACtB,qBAAKH,OAAL,CAAaG,SAAb,GAAyB,KAAKD,KAAL,CAAWC,SAAX,CAAqBC,QAArB,EAAzB;AACH;;AAED,+BAASC,mCAAT,CACI,IADJ,EAEI,KAAKH,KAAL,CAAWI,QAFf,EAGI,KAAKN,OAHT,EAII,KAAKO,YAJT;AAMH;;;uCAGc;AACX,gBAAI,KAAKL,KAAL,CAAWM,QAAf,EAAyB;AACrB,qBAAKN,KAAL,CAAWM,QAAX;AACH;AACJ;;AAED;;;;;;;;;kCAMU;AACN,mBAAO,KAAKR,OAAZ;AACH;;AAED;;;;;;;;;uCAMe;AACX,mBAAO,KAAKE,KAAL,CAAWL,SAAX,IAAwBY,SAASC,IAAxC;AACH;;;wCAEe;AACZ,gBAAI,KAAKV,OAAL,IAAgB,KAAKH,SAAzB,EAAoC;AAChC,mCAASE,sBAAT,CAAgC,KAAKC,OAArC;AACA,qBAAKH,SAAL,CAAeI,WAAf,CAA2B,KAAKD,OAAhC;AACH;;AAED,iBAAKH,SAAL,GAAiB,KAAKC,YAAL,EAAjB;AACA,iBAAKE,OAAL,GAAeS,SAASE,aAAT,CAAuB,KAAvB,CAAf;;AAEA,iBAAKd,SAAL,CAAee,WAAf,CAA2B,KAAKZ,OAAhC;AACH;;;;EAnF2B,gBAAMa,S,WAC3BC,S,GAAY;AACf;AACAR,cAAU,oBAAKS,SAAL,CAAe,CAAC,oBAAKC,OAAL,CAAa,oBAAKC,IAAlB,CAAD,EAA0B,oBAAKA,IAA/B,CAAf,CAFK;AAGf;AACAd,eAAW,oBAAKY,SAAL,CAAe,CAAC,oBAAKG,IAAN,EAAY,oBAAKC,MAAjB,CAAf,CAJI;AAKf;AACAtB,sCANe;AAOf;AACAW,cAAU,oBAAKU;AARA,C;kBAqFRxB,iB","file":"render-in-container.js","sourcesContent":["/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { autobind } from 'core-decorators';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport Type from 'prop-types';\n\nimport { HtmlElement } from '../lib/prop-types';\n\n/**\n * Компонент, позволяющий визуализировать другие компоненты в произвольном контейнере.\n */\nclass RenderInContainer extends React.Component {\n    static propTypes = {\n        /** Дочерние элементы контейнера */\n        children: Type.oneOfType([Type.arrayOf(Type.node), Type.node]),\n        /** Дополнительный класс */\n        className: Type.oneOfType([Type.func, Type.string]),\n        /** Контейнер, в котором будет визуализирован компонент */\n        container: HtmlElement,\n        /** Callback на рендер компонента */\n        onRender: Type.func\n    };\n\n    componentDidMount() {\n        this.buildElements();\n        this.renderLayer();\n    }\n\n    componentDidUpdate() {\n        if (this.container !== this.getContainer()) {\n            this.buildElements();\n        }\n        this.renderLayer();\n    }\n\n    componentWillUnmount() {\n        ReactDOM.unmountComponentAtNode(this.element);\n        this.container.removeChild(this.element);\n    }\n\n    render() {\n        return false;\n    }\n\n    renderLayer() {\n        if (this.props.className) {\n            this.element.className = this.props.className.toString();\n        }\n\n        ReactDOM.unstable_renderSubtreeIntoContainer(\n            this,\n            this.props.children,\n            this.element,\n            this.handleRender\n        );\n    }\n\n    @autobind\n    handleRender() {\n        if (this.props.onRender) {\n            this.props.onRender();\n        }\n    }\n\n    /**\n     * Возвращает HTMLElement враппера компонента.\n     *\n     * @public\n     * @returns {HTMLElement}\n     */\n    getNode() {\n        return this.element;\n    }\n\n    /**\n     * Возвращает HTMLElement контейнера, в который отрендерился компонент.\n     *\n     * @public\n     * @returns {HTMLElement}\n     */\n    getContainer() {\n        return this.props.container || document.body;\n    }\n\n    buildElements() {\n        if (this.element && this.container) {\n            ReactDOM.unmountComponentAtNode(this.element);\n            this.container.removeChild(this.element);\n        }\n\n        this.container = this.getContainer();\n        this.element = document.createElement('div');\n\n        this.container.appendChild(this.element);\n    }\n}\n\nexport default RenderInContainer;\n"]}